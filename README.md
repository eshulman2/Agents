# LlamaIndex Agents & Workflows Project

#### note: README was generated by claude please read it with suspicion

A learning project for building AI agents and workflows using LlamaIndex, featuring custom tool development, FastAPI integration, and advanced workflow orchestration. This project demonstrates how to build intelligent agents that can interact with external services like Google Calendar, Google Docs, and Jira, as well as implement complex multi-step workflows.

## üéØ Project Overview

This repository serves as a hands-on learning environment for:
- Building AI agents with LlamaIndex
- Creating custom tool specifications
- Implementing ReActAgent workflows and complex multi-step workflows
- Integrating multiple APIs (Google, Jira)
- Deploying agents as web services
- Model Context Protocol (MCP) integration
- Advanced workflow orchestration for meeting analysis

## üöÄ Features

### Implemented Agents

1. **Google Agent** (`src/llamaindex/agents/google_agent.py`)
   - Extracts action items from meeting summaries
   - Integrates with Google Calendar and Google Docs
   - Processes meeting notes and attached documents
   - Enhanced API endpoints for specific operations

2. **Jira Agent** (`src/llamaindex/agents/jira_agent.py`)
   - Creates and manages Jira tickets
   - Fetches Jira data and comments on tickets
   - Integrates with Jira API for project management
   - Advanced ticket management capabilities

### Workflow System

3. **ActionItems Workflow** (`src/llamaindex/workflows/action_items_workflow.py`)
   - Multi-step workflow for processing meeting notes
   - Automated action item generation with review cycles
   - JSON validation and error handling
   - Reflection-based improvement system

### MCP Integration

4. **Model Context Protocol Support** (`src/mcp/`)
   - Google Tools MCP server for Google Calendar and Docs integration
   - Enhanced agent capabilities through MCP tools
   - Standalone MCP server deployment for tool access

### Observability & Monitoring

5. **Langfuse Integration**
   - Real-time monitoring of agent interactions
   - Performance metrics and trace analysis
   - Debugging and optimization insights
   - Configurable observability through environment variables

### Custom Tool Specifications

- **Google Tools**: Calendar operations, document processing
- **Jira Tools**: Ticket management, issue tracking
- **General Tools**: Date utilities and helper functions

## üõ†Ô∏è Setup Instructions

### Prerequisites

- Python 3.11+
- Docker (optional)
- Google API credentials
- Jira API token

### Local Development Setup

1. **Clone the repository**
   ```bash
   git clone <repository-url>
   cd agents
   ```

2. **Install dependencies**
   ```bash
   pip install -r requirements.txt
   ```

3. **Configure Google API credentials**
   - Place your `credentials.json` file in the root directory
   - Ensure `token.json` is generated (will be created on first auth)

4. **Set environment variables**
   ```bash
   export JIRA_API_TOKEN="your_jira_api_token"
   export MODEL_API_KEY="your_api_key"
   ```

5. **Update configuration**
   - Edit `config.json` to match your settings
   - Update Jira server URL if needed

### Docker Setup

#### Single Container Build
1. **Build specific containers**
   ```bash
   # Jira Agent
   docker build -f containers/Dockerfile.llamaindex-jira-agent -t jira-agent .

   # Google Agent
   docker build -f containers/Dockerfile.llamaindex-google-agent -t google-agent .

   # Workflows
   docker build -f containers/Dockerfile.llamaindex-workflows -t llamaindex-workflows .

   # Google MCP Server
   docker build -f containers/Dockerfile.google-mcp -t google-tools-mcp .
   ```

2. **Run individual containers**
   ```bash
   # Run with required environment variables
   docker run -p 8000:8000 \
     -e MODEL_API_KEY="your_model_api_key" \
     -e LOG_LEVEL="INFO" \
     -v $(pwd)/config.json:/run/secrets/config:ro \
     -v $(pwd)/credentials.json:/app/credentials.json \
     -v $(pwd)/token.json:/app/token.json \
     jira-agent
   ```

#### Docker Compose Setup (Recommended)

1. **Set environment variables**
   ```bash
   export MODEL_API_KEY="your_model_api_key"
   export LOG_LEVEL="INFO"  # Optional, defaults to INFO
   ```

2. **Run all services**
   ```bash
   docker-compose up --build
   ```

3. **Access services**
   - Jira Agent: http://localhost:8000
   - Google Agent: http://localhost:8001
   - LlamaIndex Workflows: http://localhost:8002
   - Google MCP Server: http://localhost:8100

4. **Configuration**
   - Config file is mounted as a Docker secret at `/run/secrets/config`
   - Environment variables are automatically injected into containers
   - All services share the same configuration and secrets

## üöÄ Usage

### Running Individual Agents

**Google Agent:**
```bash
cd src
uvicorn src.llamaindex.agents.google_agent:app --reload --port 8001
```

**Jira Agent:**
```bash
cd src
uvicorn src.llamaindex.agents.jira_agent:app --reload --port 8002
```

### Running Workflows

**ActionItems Workflow:**
```python
from src.llamaindex.workflows.action_items_workflow import WorkItemWorkflow

# Initialize workflow with max iterations
workflow = WorkItemWorkflow(max_iterations=3)

# Run workflow with meeting notes
result = await workflow.run(meeting_notes="Your meeting notes here")
```

### API Endpoints

Each agent exposes the following endpoints:

- `GET /` - Health check and API info
- `POST /test` - Test endpoint without context
- `POST /agent` - Main agent endpoint with full context
- `GET /docs` - Interactive API documentation

### Example Usage

**Query the Google Agent:**
```bash
curl -X POST "http://localhost:8001/agent" \
     -H "Content-Type: application/json" \
     -d '{"query": "Extract action items from my last meeting"}'
```

**Query the Jira Agent:**
```bash
curl -X POST "http://localhost:8002/agent" \
     -H "Content-Type: application/json" \
     -d '{"query": "Create a ticket for bug fix in authentication module"}'
```

**Use Workflow for Meeting Processing:**
```bash
curl -X POST "http://localhost:8001/workflow" \
     -H "Content-Type: application/json" \
     -d '{"meeting_notes": "Meeting discussion about project updates and action items"}'
```

## üîß Configuration

### config.json Structure

```json
{
    "llm": "Gemini",
    "model": "gemini-2.0-flash",
    "tools_config": {
        "jira_tool": {"server": "https://your-jira-instance.com"}
    },
    "agent_config": {
        "max_iterations": 20,
        "verbose": true
    },
    "mcp_config": {
        "port": 8100,
        "servers": [
            "http://127.0.0.1:8100/mcp"
        ]
    },
    "observability": {
        "enable": true,
        "secret_key": "sk-lf-your-secret-key",
        "public_key": "pk-lf-your-public-key",
        "host": "http://localhost:3000"
    }
}
```

### Environment Variables

Required environment variables for all services:

- `MODEL_API_KEY`: API key for the LLM model (Gemini)
- `CONFIG_PATH`: Path to config file (automatically set to `/run/secrets/config` in containers)
- `LOG_LEVEL`: Logging level (default: INFO)

## üèóÔ∏è Architecture

### Base Agent Server

The `BaseAgentServer` class (`src/llamaindex/base_agent_server.py`) provides common FastAPI functionality:
- Request/response models
- Error handling
- Route setup
- Agent context integration
- Enhanced API endpoints for specific operations

### Workflow System

The workflow system (`src/llamaindex/workflows/`) enables:
- Multi-step processing with event-driven architecture
- Automatic retry mechanisms with configurable limits
- Review and validation cycles
- JSON format validation
- Memory management for conversation context

### Tool Specifications

Custom tools are organized by category in `src/tools/`:
- **General Tools**: Date utilities, helper functions
- **Google Tools**: Calendar and Docs API integration
- **Jira Tools**: Issue management and API operations

### MCP Integration

Model Context Protocol support (`src/mcp/`) provides:
- Gmail integration for email processing
- Extensible MCP server support
- Enhanced agent capabilities through external tools

### Agent Context

Each agent has specific context defined in `src/configs/agents_contexts.py`:
- Google Agent: Meeting summary processing and action item extraction
- Jira Agent: Ticket management operations

## üß™ Development

### Adding New Agents

1. Create a new agent file in `src/llamaindex/agents/`
2. Extend `BaseAgentServer`
3. Define agent context in `src/configs/agents_contexts.py`
4. Initialize with required tools and LLM

### Creating Custom Workflows

1. Create workflow file in `src/llamaindex/workflows/`
2. Extend `Workflow` class from LlamaIndex
3. Define event classes for workflow steps
4. Implement step methods with `@step` decorator
5. Add proper error handling and retry logic

### Creating Custom Tools

1. Create tool specification class
2. Implement required methods
3. Add to appropriate tools package
4. Import in agent configuration

## üìö Learning Resources

- [LlamaIndex Documentation](https://docs.llamaindex.ai/)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Google APIs Python Client](https://github.com/googleapis/google-api-python-client)
- [Jira Python Library](https://jira.readthedocs.io/)

## üìù License

This project is for educational purposes. Please ensure you comply with the terms of service for all integrated APIs (Google, Jira, etc.).
